<!DOCTYPE html>
<html lang="en">

<head>
	<title>Mosaic renderer demo</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<style>
		body {
			color: #000;
			font-family: Monospace;
			font-size: 13px;
			text-align: center;
			font-weight: bold;

			background-color: #000;
			margin: 0px;
			overflow: hidden;
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		#info {
			position: absolute;
			padding: 10px;
			width: 100%;
			text-align: center;
			color: #fff;
		}

		a {
			color: blue;
		}
	</style>
</head>

<body id="body">
	<div id="info">
		<div id="debug">
		</div>
	</div>

	<script id="vertexShader" type="shader">
		varying vec2 vUv;
				
		void main() {
			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );
		}
	</script>
			
	<script id="fragmentShader" type="shader">
		uniform sampler2D texture;
		uniform int useColors;
		uniform int blurStrength;

		varying vec2 vUv;

		vec3 desaturize(vec3 color)
		{
			float grayScale = dot(color, vec3(0.299, 0.587, 0.114));
			return vec3(grayScale, grayScale, grayScale);
		}

		void main() 
		{
			float n = 8.0;
			const int delta = 100; //width of billboard

			if (blurStrength > 0)
			{
				//gl_FragColor = vec4(1,0,0,0);
				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv + vec2(0.0001, 0.001) );
				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv - vec2(0.0001, 0.001) );

				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv + vec2(0.0002, 0) );
				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv - vec2(0.0002, 0) );

				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv + vec2(0.0003, 0.001) );
				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv - vec2(0.0003, 0.001) );

				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv + vec2(0.0004, 0) );
				gl_FragColor += vec4(1.0/n)*texture2D(texture, vUv - vec2(0.0004, 0) );
			}
			else
			{
				gl_FragColor = texture2D(texture, vUv);
			}

			if (useColors==0)
			{
				gl_FragColor = vec4(desaturize(gl_FragColor.rgb),0);
			}
						
		}
	</script>

	<script src="./build/three.js"></script>
	<script src="./js/controls/OrbitControls.js"></script>
	<script src="./js/Detector.js"></script>
	<script src='mosaicViewer.js'>

	</script>
</body>

</html>